# Report

## 功能实现

本实验实现了三个系统调用： `sys_linkat, sys_unlinkat, sys_fstat`

其中， `sys_fstat` 系统调用要求获取文件的状态。因此当调用时，系统根据当前任务以及文件描述符获取 `OSInode` 。在 trait `File` 中添加了方法 `stat` 用来获取对应的文件状态。因此从 `fd_table` 中获取到查询的 `OSInode` 后直接调用它的 `stat` 方法。该方法会获取当前inode的一些基本信息，并从 `ROOT_INODE` 中查询的到 `nlink` 的数量。

`sys_linkat` 系统调用要求创建一个文件的硬链接。在获取到 `old_name, new_name` 后，会调用 `fs` 中定义的 `link_file` ，以在 `ROOT_INODE` 中进行 `link` 的操作。 `link` 操作类似于 `Inode` 中的其他操作，运用 `modify_disk_inode` 等函数来对 `DiskInode` 进行访问。首先使用 `old_name` 来查找对应的 `inode_id` ，然后在块后新增一段记录 `new_name` 指向 `inode_id` 的部分。

`sys_unlinkat` 类似于 `sys_linkat` ，遍历每一对记录，若记录的名称为 `name` ，则修改该块。

## 问答题

1. 在我们的easy-fs中，root inode起着什么作用？如果root inode中的内容损坏了，会发生什么？
    root inode用来作为查询根目录下各个文件的入口。如果root inode中的内容损坏，则各个文件名与inode编号之间的对应关系将会混乱。

## 荣誉准则

1. 在完成本次实验的过程（含此前学习的过程）中，我曾分别与 **以下各位** 就（与本次实验相关的）以下方面做过交流，还在代码中对应的位置以注释形式记录了具体的交流对象及内容：

无

2. 此外，我也参考了 **以下资料** ，还在代码中对应的位置以注释形式记录了具体的参考来源及内容：

无

3. 我独立完成了本次实验除以上方面之外的所有工作，包括代码与文档。 我清楚地知道，从以上方面获得的信息在一定程度上降低了实验难度，可能会影响起评分。

4. 我从未使用过他人的代码，不管是原封不动地复制，还是经过了某些等价转换。 我未曾也不会向他人（含此后各届同学）复制或公开我的实验代码，我有义务妥善保管好它们。 我提交至本实验的评测系统的代码，均无意于破坏或妨碍任何计算机系统的正常运转。 我清楚地知道，以上情况均为本课程纪律所禁止，若违反，对应的实验成绩将按“-100”分计。